%&header

\documentclass[10.5pt,a4paper,DIV=15]{scrartcl}


\usepackage{amsmath}
\usepackage{subcaption}
%
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage{makecell}
\usepackage{booktabs}
\usepackage{rotating}
\usepackage{float}
\usepackage{layouts}
\usepackage{pgf}
\usepackage{fancyvrb}

\usepackage{todonotes}
\usepackage[hidelinks]{hyperref}

\usepackage{tikz}

\usepackage{crimson}
\usepackage{newtxmath}
\usepackage{polyglossia}
\usepackage[natbib=true,style=authoryear,backend=biber]{biblatex}
\usepackage{microtype}
\usepackage{minted}
\usepackage{xstring}
\usepackage{newunicodechar}

\usepackage{setspace}
\onehalfspacing{}

\usepackage[column=C]{cellspace}

\usepackage[bottom=2.5cm,top=2.0cm,left=2.4cm,right=2.4cm]{geometry}

\usepackage[detect-all,binary-units,separate-uncertainty=true,round-mode=uncertainty,input-digits={0123456789ABCDEF}]{siunitx}

\setdefaultlanguage{english}

\NewCommandCopy{\oldautocite}{\autocite}
\renewcommand{\autocite}[1]{ \oldautocite{#1}}

\cellspacetoplimit4pt
\cellspacebottomlimit4pt



\usepackage[toc]{glossaries}

\renewcommand\cellalign{lc}

\ExecuteBibliographyOptions{mincrossrefs=100}

\makeglossaries

% \usepackage{nomencl}
% \let\abbrev\nomenclature
% \renewcommand{\nomname}{List of Abbreviations}
% \setlength{\nomlabelwidth}{.25\hsize}
% \renewcommand{\nomlabel}[1]{#1 \dotfill}
% \setlength{\nomitemsep}{-\parsep}
% %\makeglossary
% \makenomenclature%
% \newcommand{\markup}[1]{\uline{#1}}
% \usepackage{makeidx}                              % index of key words
% \makeindex

\raggedbottom%


\newcommand{\thesisTitle}{Implementation of an \FPGA{}-based memory mapped buffer for real-time communication with a neuromorphic \ASIC{}}
\newcommand{\thesisTitleGerman}{Entwicklung eines \FPGA{}-basierten memory-mapped Zwischenspeicher für Echtzeit-Kommunikation mit einem neuromorphen \ASIC{}}

\providecommand*{\listingautorefname}{Listing}



\usetikzlibrary{external}
\tikzexternalize[up to date check={simple},prefix=./external_figures/]
\usetikzlibrary{arrows,arrows.meta,bending,positioning,calc,patterns,backgrounds,fit,decorations.pathreplacing,shapes.geometric}

\newcommand\MeanStdValue[2]{%
  \ensuremath{%
    \SI{\csname #1Mean\endcsname \pm \csname #1Std\endcsname}{#2}%
  }%
}

% ugh
\newcommand{\inputtikz}[1]{\StrSubstitute{#1}{/}{-}[\filename]\StrSubstitute{\filename}{.}{-}[\filenameNew]\tikzsetnextfilename{\filenameNew}\input{#1}}

\newcommand{\inputpgf}[1]{
\StrSubstitute{#1}{/}{-}[\filename]\StrSubstitute{\filename}{.}{-}[\filenameNew]\tikzsetnextfilename{\filenameNew}%
\centerline{\begin{tikzpicture}\node[inner sep=0pt]{\input{#1}};\end{tikzpicture}}%
}%

\definecolor{color0}{HTML}{1f77b4}  % blue
\definecolor{color1}{HTML}{ff7f0e}  % orange
\definecolor{color2}{HTML}{2ca02c}  % green
\definecolor{color3}{HTML}{d62728}  % red
\definecolor{color4}{HTML}{9467bd}  % purple
\definecolor{color5}{HTML}{8c564b}  % red-gray
\definecolor{color6}{HTML}{e377c2}  % pink
\definecolor{color7}{HTML}{7f7f7f}  % gray
\definecolor{color8}{HTML}{bcbd22}  % incredibly ugly yellow-gray
\definecolor{color9}{HTML}{17becf}  % light blue

% colors for multi-compartment illustrations
\colorlet{comp0}{color1!60}
\colorlet{comp1}{color5!60}
\colorlet{comp2}{color8!60}
\colorlet{comp3}{color2!60}
\colorlet{comp4}{color3!60}
\colorlet{comp5}{color6!60}

% \tikzset{external/system call={lualatex -halt-on-error -shell-escape -interaction=batchmode -fmt header -jobname "\image" "\texsource"}}

% ugh
\makeatletter
\renewcommand{\todo}[2][]{\tikzexternaldisable\@todo[#1]{#2}\tikzexternalenable}
\makeatother

\newunicodechar{α}{\alpha}
\newunicodechar{Α}{\alpha}
\newunicodechar{β}{\beta}
\newunicodechar{Β}{\beta}
\newunicodechar{γ}{\gamma}
\newunicodechar{δ}{\delta}
\newunicodechar{ε}{\varepsilon}
\newunicodechar{Ε}{\varepsilon}
\newunicodechar{ζ}{\zeta}
\newunicodechar{η}{\eta}
\newunicodechar{θ}{\theta}
\newunicodechar{ι}{\iota}
\newunicodechar{κ}{\kappa}
\newunicodechar{λ}{\lambda}
\newunicodechar{μ}{\mu}
\newunicodechar{Μ}{\Mu}
\newunicodechar{ν}{\nu}
\newunicodechar{ξ}{\xi}
\newunicodechar{ο}{\omicron}
\newunicodechar{π}{\pi}
\newunicodechar{Π}{\Pi}
\newunicodechar{ρ}{\rho}
\newunicodechar{Ρ}{\Rho}
\newunicodechar{σ}{\sigma}
\newunicodechar{τ}{\tau}
\newunicodechar{Τ}{\Tau}
\newunicodechar{υ}{\upsilon}
\newunicodechar{φ}{\varphi}
\newunicodechar{χ}{\chi}
\newunicodechar{ψ}{\psi}
\newunicodechar{ω}{\omega}
\newunicodechar{∀}{\forall}
\newunicodechar{×}{\times}
\newunicodechar{Γ}{\Gamma}
\newunicodechar{Δ}{\Delta}
\newunicodechar{∃}{\exists}
\newunicodechar{ℤ}{\mathbb{Z}}
\newunicodechar{∧}{\wedge}
\newunicodechar{Θ}{\Theta}
\newunicodechar{⇒}{\implies}
\newunicodechar{∩}{\cap}
\newunicodechar{Λ}{\Lambda}
\newunicodechar{∫}{\int}
\newunicodechar{ℕ}{\mathbb{N}}
\newunicodechar{Ξ}{\Xi}
\newunicodechar{∇}{\nabla}
\newunicodechar{Π}{\Pi}
\newunicodechar{ℝ}{\mathbb{R}}
\newunicodechar{Σ}{\Sigma}
\newunicodechar{⇔}{\iff}
\newunicodechar{Υ}{\Upsilon}
\newunicodechar{Φ}{\Phi}
\newunicodechar{ℂ}{\mathbb{C}}
\newunicodechar{Ψ}{\Psi}
\newunicodechar{Ω}{\Omega}
\newunicodechar{ϑ}{\vartheta}
\newunicodechar{∞}{\infty}
\newunicodechar{∈}{\in}
\newunicodechar{⊂}{\subset}
\newunicodechar{ϰ}{\varkappa}
\newunicodechar{ϕ}{\phi}
\newunicodechar{∨}{\vee}
\newunicodechar{∮}{\oint}
\newunicodechar{↦}{\mapsto}
\newunicodechar{ℚ}{\mathbb{Q}}
\newunicodechar{⊆}{\subseteq}
\newunicodechar{⊊}{\subsetneq}
\newunicodechar{∪}{\cup}
\newunicodechar{·}{\cdot}


\addbibresource{bib.bib}
\addbibresource{vision.bib}

% \pagestyle{scrheadings}

% \usemintedstyle{tango}
\usemintedstyle{friendly}
\setminted[]{breaklines=true,linenos,frame=lines,mathescape=true,tabsize=4}

% \title{ba writeup}
% \author{Robin Heinemann}
% \date{February 2023}

\input{values.tex}
\input{data.tex}

% \renewcommand\autocite[1]{??}

\begin{document}

\pagestyle{empty}
\include{ba_titlepage}


\pagebreak

% abstract:
% general beschreibung -> 1 Satz: Der BSS-2 ASIC ist mixed signal neuromorphic analog asic, physical model of neurons, echtzeit analog + digital control.
% Dann first three sentences
% dann
% problem statement:
% es gibt schon etwas dass das tut, es ist limitiert, was sind limitationen
% dann
% what did I do:


\begin{abstract}
\begin{center}
\textbf{\thesisTitle}
\end{center}
BrainScaleS-2 is a mixed signal neuromorphic \ASIC{} combining accelerated physical emulation of brain-inspired neurons and synapses with digital control logic. Experiments using the \HICANNX{} require real-time stimuli, since the analog emulation performed by the \ASIC{} cannot be stopped an continued arbitrarily. This real-time communication is realized using an \FPGA{}. A buffer for the data to be sent to the \ASIC{} and for data received from the \ASIC{} is necessary due to the mismatch of bandwidth between the \FPGA{} and the host computer performing the experiment and the bandwidth between the \FPGA{} and the \ASIC{}. The current buffer implementation has several limitations. It is not able to make use of all of the connected \DRAM{} and the bandwidth of the buffer is smaller than the bandwidth between the \FPGA{} and the \ASIC{} for some cases, leading to nondeterministic timing that can reduce reproducibility.
This thesis presents a new design for this buffer that trades a lower maximum rate of experiments for the ability to use the full size of the connected \DRAM{} of \DDRSIZE{}. The bandwidth is increased to always provide deterministic timing. Furthermore, the options for organization of data to be transmitted to and data received from the \ASIC{} are extended to allow repeated use and sparse readout of data. Basic integration with the \BSSTwo{} software stack was performed as well.

\begin{center}
\textbf{\thesisTitleGerman}
\end{center}
Der BrainScaleS-2 Mixed-Signal neuromorphe \ASIC{} kombiniert eine beschleunigte physikalische Emulation von dem Gehirn nachempfundenen Neuronen und Synapses mit digitaler Logik zur Konfiguration. Experimente mit dem \HICANNX{} setzen Echtzeit-Stimuli vorraus, da die analoge Emulation, die von dem \ASIC{} durchgeführt wird, nicht pausiert und wieder gestartet werden kann. Diese Echtzeit-Kommunikation wird mittels eines \FPGA{}s umgesetzt. Ein Zwischenspeicher auf dem \FPGA{} ist notwending da die Daten-Bandbreite zwischen dem \FPGA{} und dem \ASIC{} größer ist als die Bandbreite zwischen \FPGA{} und Computer für die Durchführung der Experimente. Die aktuelle Umsetzung dieses Zwischenspeicher hat den Nachteil das nicht der komplette an den \FPGA{} angeschlossene Speicher ausgenutzt werden kann. Außerdem ist in manchen Fällen die vom Zwischenspeicher erreichte Bandbreite kleiner als die Bandbreite zwischen \ASIC{} und \FPGA{}, wodurch die Wiederholbarkeit von Experimenten reduziert wird.
In dieser Arbeit wird eine neue Architektur für diesen Zwischenspeicher entwickelt und umgesetzt.
Die Ausnutzung des ganzen an den \FPGA{} angebundenen \DDR{} Speichers wird ermöglicht und vergrößert damit den Zwischenspeicher von $\SI{64}{\mebi\byte}$ auf \DDRSIZE. Außerdem ist die Bandbreite groß genug um deterministische zeitlich Übertragung der Daten zu garantieren. Zusätzlich wiederholtes Senden und partielles Auslesen der Daten ermöglicht. Der einzige Nachteil ist die Reduktion der maximale Rate an Experimenten die mit dem neuen Zwischenspeicher durchgeführt werden können. Vorschläge zur Verbesserung dieser Rate werden vorgestellt.

\end{abstract}
\pagebreak

\tableofcontents


\pagestyle{plain}

\setcounter{page}{1}
\pagenumbering{arabic}

\include{introduction.tex}
\include{background.tex}
\include{implementation.tex}
\include{results.tex}
\include{discussion.tex}
% \include{outlook.tex}

\printbibliography
\include{declaration}

\end{document}
